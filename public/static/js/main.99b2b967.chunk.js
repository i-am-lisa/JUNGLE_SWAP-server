(this["webpackJsonpJUNGLE_SWAP-client"]=this["webpackJsonpJUNGLE_SWAP-client"]||[]).push([[0],{55:function(e,t,n){},63:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),s=n(21),r=n.n(s),i=(n(55),n(18)),l=n(37),o=n(6),d=n(7),j=n(9),u=n(8),b=n(0);var m=function(e){return Object(b.jsx)("div",{className:"container row mt-5 custom fullscreen",children:Object(b.jsx)("div",{className:"mt-5 col-11 col-md-5 offset-1 offset-md-5",children:Object(b.jsxs)("form",{onSubmit:e.onSignIn,children:[Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{htmlFor:"InputEmail",children:" Email address "}),Object(b.jsx)("input",{type:"email",className:"form-control",id:"InputEmail",name:"email"})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{htmlFor:"InputPassword",children:" Password "}),Object(b.jsx)("input",{name:"password",type:"password",className:"form-control",id:"InputPassword"})]}),Object(b.jsx)("button",{type:"submit",className:"btn btn-primary mt-4 btn-outline-dark",children:" Sign in "})]})})})},h=n(4);var p=function(e){return Object(b.jsx)("div",{className:"container row mt-5",children:Object(b.jsx)("div",{className:"mt-5 col-11 col-md-5 offset-1 offset-md-5",children:Object(b.jsxs)("form",{onSubmit:e.onSignUp,children:[Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{htmlFor:"InputUsername",children:" Username "}),Object(b.jsx)("input",{type:"text",className:"form-control",id:"InputUsername",name:"username"})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{htmlFor:"InputEmail",children:" Email address "}),Object(b.jsx)("input",{type:"email",className:"form-control",id:"InputEmail",name:"email"})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{htmlFor:"InputPassword",children:" Password "}),Object(b.jsx)("input",{name:"password",type:"password",className:"form-control",id:"InputPassword"})]}),e.error?Object(b.jsx)("p",{style:{color:"red"},children:e.error.errorMessage}):null,Object(b.jsx)("button",{type:"submit",className:"btn btn-primary mt-4 btn-outline-dark",children:" Sign up "}),Object(b.jsx)("p",{children:"Already have an account?"}),Object(b.jsx)(h.b,{to:"/signin",children:"Sign in"})]})})})},O=(n(62),n(63),n(5)),f="https://jungle-swap.herokuapp.com",x=n(10),g=n.n(x),v=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"componentDidMount",value:function(){!function(e,t){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://widget.kommunicate.io/v2/kommunicate.app",document.getElementsByTagName("head")[0].appendChild(n),window.kommunicate=t,t._globals={appId:"359e94bbb245c09ca5b9f4f2b549ce9da",popupWidget:!0,automaticChatOpenOnNavigation:!0}}(document,window.kommunicate||{})}},{key:"render",value:function(){return Object(b.jsx)("div",{})}}]),n}(a.Component),y=n(25),N=n.p+"static/media/JungleSwap_Home.c4ed9b4c.png",S=n.p+"static/media/JungleSwap_Icon.a6c7c44a.png",w=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.plants,n=e.query;return Object(b.jsxs)("div",{children:[Object(b.jsx)("header",{className:"text-center pt-5 pb-5 headerImg",children:Object(b.jsx)("div",{className:"row my-5",children:Object(b.jsxs)("div",{className:"col-6 offset-3 my-5 borderAround",children:[Object(b.jsx)("h2",{className:"title mb-2",children:" JungleSwap "}),Object(b.jsx)("h5",{className:"mt-3 mb-5",children:"Share your green heart"}),Object(b.jsx)("div",{className:"mb-5",children:Object(b.jsx)(y.ScrollTo,{children:function(e){var t=e.scroll;return Object(b.jsx)(h.b,{className:"biggerFontSize",onClick:function(){return t({y:820,smooth:!0})},children:" Try it! "})}})})]})})}),Object(b.jsx)(v,{}),Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{class:"intro",children:Object(b.jsx)("div",{class:"intro-centered container",children:Object(b.jsxs)("div",{class:"row",children:[Object(b.jsx)("div",{class:"col-sm-6 col-md-5 col-lg-6",children:Object(b.jsx)("img",{class:"image",src:N,alt:""})}),Object(b.jsxs)("div",{class:"intro col-sm-6 col-md-5 col-lg-6 px-5",children:[Object(b.jsx)("h4",{children:" Welcome to JungleSwap!"}),Object(b.jsx)("h5",{children:"Add green to your Home"}),Object(b.jsxs)("p",{children:["It's easy-peasy.",Object(b.jsx)("br",{}),Object(b.jsx)("br",{}),"Share your plant offshoots.",Object(b.jsx)("br",{}),"Make money!",Object(b.jsx)("br",{}),Object(b.jsx)("br",{}),"Or swap them for another plant.",Object(b.jsx)("br",{}),Object(b.jsx)("br",{}),"Don't have any baby plants? ",Object(b.jsx)("br",{}),"You can simply shop and give a plant a new home."]}),Object(b.jsx)("img",{class:"icon",src:S,alt:""})]})]})})}),Object(b.jsxs)("div",{className:"container mt-5",children:[Object(b.jsxs)("div",{className:"mt-4 mb-3 pt-5",children:[Object(b.jsx)("h2",{children:"Plants"}),Object(b.jsx)("hr",{}),Object(b.jsx)("h4",{children:"Search a plant"})]}),Object(b.jsx)("div",{className:"mb-4",children:Object(b.jsx)("input",{className:"smallWidth form-control",type:"text",placeholder:"Search...",value:n,onChange:this.props.onSearch})}),Object(b.jsx)("div",{className:"row row-cols-1 row-cols-md-3 g-4",children:t.map((function(e){return Object(b.jsx)("div",{className:"col mb-5",children:Object(b.jsxs)("div",{className:"h-100 card text-center",children:[Object(b.jsx)("img",{className:"card-img-top",src:e.image,alt:e.name}),Object(b.jsxs)("div",{className:"card-body mb-5",children:[Object(b.jsxs)("h5",{children:[" ",e.name," "]}),Object(b.jsxs)("p",{children:[e.price," \u20ac"]}),Object(b.jsx)(h.b,{className:"btn btn-outline-dark",to:"/plants/".concat(e._id),children:" Details "})]})]})},e._id)}))})]})]})]})}}]),n}(a.Component),C=n(89),k=n(90);var I=function(e){return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)(C.a,{className:"pl-5",variant:"dark",expand:"lg",fixed:"top",children:[Object(b.jsx)(C.a.Brand,{href:"/",children:" JungleSwap "}),Object(b.jsx)(C.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(b.jsx)(C.a.Collapse,{id:"basic-navbar-nav",children:Object(b.jsxs)(k.a,{className:"mr-auto",children:[Object(b.jsx)(h.b,{className:"p-2",to:"/add-form",children:" Add Plant "}),Object(b.jsx)(y.ScrollTo,{children:function(e){var t=e.scroll;return Object(b.jsx)(h.b,{className:"p-2",onClick:function(){return t({y:1700,smooth:!0})},children:"All Plants"})}}),Object(b.jsx)(h.b,{className:"p-2",to:"/myrequests",children:" Messages "}),e.user?Object(b.jsx)(h.b,{className:"p-2",to:"/logout",children:" Log out "}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(h.b,{className:"p-2",to:"/signin",children:" Sign in "}),Object(b.jsx)(h.b,{className:"p-2",to:"/signup",children:" Sign up "})]})]})})]})})},q=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(b.jsx)("div",{class:"footer-row",children:Object(b.jsxs)("footer",{children:["Copyright \xa9 2021 ",Object(b.jsx)("a",{href:"https://www.linkedin.com/in/christian-gerbig/",children:"Christian Gerbig"})," & ",Object(b.jsx)("a",{href:"https://www.linkedin.com/in/lisa-montebaur/",children:"Lisa Montebaur"})]})})}}]),n}(a.Component),P=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return this.props.user?Object(b.jsx)("div",{className:"container row mt-5 fullscreen",children:Object(b.jsxs)("div",{className:"mt-5 col-11 col-md-5 offset-1 offset-md-6",children:[Object(b.jsx)("h2",{className:"mt-5 mb-5",children:"Upload a plant"}),Object(b.jsxs)("form",{onSubmit:this.props.onAdd,children:[Object(b.jsx)("input",{className:"mb-4",name:"name",type:"text",placeholder:"Enter name"}),Object(b.jsx)("input",{className:"mb-4",name:"description",type:"text",placeholder:"Enter description"}),Object(b.jsx)("input",{className:"mb-4 smallWidth",name:"size",type:"number",min:"1",placeholder:"Size"})," cm ",Object(b.jsx)("br",{}),Object(b.jsxs)("select",{className:"mb-4 p-1",name:"location",type:"text",children:[Object(b.jsx)("option",{children:" Select location "}),Object(b.jsx)("option",{value:"sun",children:" sun "}),Object(b.jsx)("option",{value:"shade",children:" shade "}),Object(b.jsx)("option",{value:"sun and shade",children:" sun and shade "})]}),Object(b.jsx)("br",{}),Object(b.jsx)("input",{className:"mb-4 smallWidth",name:"price",type:"number",min:"1",placeholder:"Price"})," \u20ac ",Object(b.jsx)("br",{}),Object(b.jsx)("input",{className:"mb-4",name:"plantImage",type:"file"}),Object(b.jsxs)("div",{className:"col-12",children:[Object(b.jsx)("button",{className:"btn btn-sm btn-outline-dark",type:"submit",children:" Add plant "}),Object(b.jsx)(h.b,{to:"/",children:Object(b.jsx)("button",{className:"btn btn-sm mx-5",children:" Go back "})})]})]})]})}):Object(b.jsx)(O.a,{to:"/signup"})}}]),n}(a.Component),E=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).state={plant:{}},e.handleNameChange=function(t){var n=t.target.value,a=JSON.parse(JSON.stringify(e.state.plant));a.name=n,e.setState({plant:a})},e.handleDescChange=function(t){var n=t.target.value,a=JSON.parse(JSON.stringify(e.state.plant));a.description=n,e.setState({plant:a})},e.handleSizeChange=function(t){var n=t.target.value,a=JSON.parse(JSON.stringify(e.state.plant));a.size=n,e.setState({plant:a})},e.handlePriceChange=function(t){var n=t.target.value,a=JSON.parse(JSON.stringify(e.state.plant));a.price=n,e.setState({plant:a})},e.handleLocationChange=function(t){var n=t.target.value,a=JSON.parse(JSON.stringify(e.state.plant));a.location=n,e.setState({plant:a})},e.handleImageChange=function(t){var n=t.target.files[0],a=new FormData;a.append("imageUrl",n),g.a.post("".concat(f,"/api/upload"),a).then((function(t){var n=JSON.parse(JSON.stringify(e.state.plant));n.image=t.data.image,e.setState({plant:n}),console.log(n)})).catch((function(e){console.log("Image upload failed",e)}))},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.plantId;g.a.get("".concat(f,"/api/plants/").concat(t)).then((function(t){e.setState({plant:t.data})})).catch((function(){console.log("Detail fetch failed")}))}},{key:"render",value:function(){var e=this.state.plant,t=this.props.onEdit;return Object(b.jsx)("div",{className:"container row mt-5 fullscreen",children:Object(b.jsxs)("div",{className:"mt-2 col-11 col-md-5 offset-1 offset-md-5",children:[Object(b.jsx)("h2",{className:"mt-5 mb-4",children:" Edit your plant "}),Object(b.jsxs)("div",{className:"card cardSmallWidth mb-5",children:[Object(b.jsx)("img",{className:"mb-2 smallPicSize",src:e.image,alt:e.name}),Object(b.jsxs)("div",{className:"card-body",children:[Object(b.jsx)("input",{className:"mb-2",onChange:this.handleImageChange,type:"file"}),Object(b.jsx)("input",{className:"mb-2",type:"text",onChange:this.handleNameChange,value:e.name}),Object(b.jsx)("input",{className:"mb-2",type:"text",onChange:this.handleDescChange,value:e.description}),Object(b.jsx)("input",{className:"mb-2 smallWidth",type:"number",onChange:this.handleSizeChange,value:e.size})," cm ",Object(b.jsx)("br",{}),Object(b.jsxs)("select",{className:"mb-2",onChange:this.handleLocationChange,name:"location",type:"text",placeholder:"Select",children:[Object(b.jsx)("option",{value:"sun",children:" sun "}),Object(b.jsx)("option",{value:"shade",children:" shade "}),Object(b.jsx)("option",{value:"sun and shade",children:" sun and shade "})]})," ",Object(b.jsx)("br",{}),Object(b.jsx)("input",{className:"mb-4 smallWidth",name:"price",type:"number",min:"1",onChange:this.handlePriceChange,value:e.price})," \u20ac",Object(b.jsxs)("div",{className:"row justify-content-around",children:[Object(b.jsx)("button",{className:"btn btn-sm btn-outline-dark",onClick:function(){t(e)},children:" Save changes "}),Object(b.jsx)(h.b,{to:"/plants/".concat(e._id),children:Object(b.jsx)("button",{className:"btn btn-sm mx-2 btn-outline-dark",children:" Go back "})})]})]})]})]})})}}]),n}(a.Component),J=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).state={plant:{}},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.plantId;g.a.get("".concat(f,"/api/plants/").concat(t),{withCredentials:!0}).then((function(t){e.setState({plant:t.data})})).catch((function(){console.log("Detail fetch failed")}))}},{key:"render",value:function(){var e=this.state.plant,t=this.props,n=t.onDelete,a=t.user;return a?Object(b.jsxs)("div",{className:"container mt-5 row row-md-10 offset-1 offset-md-4 fullscreen",children:[Object(b.jsx)("div",{className:"mt-4 mb-3 pt-4 container",children:Object(b.jsx)("h2",{children:" Plant details "})}),Object(b.jsx)("div",{className:"col",children:Object(b.jsxs)("div",{className:"card cardMediumWidth",children:[e.image?Object(b.jsx)("img",{className:"card-img-top mediumPicSize",src:e.image,alt:e.name}):null,Object(b.jsxs)("div",{className:"ml-2 mt-2",children:[" ",Object(b.jsx)("span",{children:" Name: "})," ",e.name," "]}),Object(b.jsxs)("div",{className:"ml-2 mt-2",children:[" ",Object(b.jsx)("span",{children:" Description: "})," ",e.description," "]}),Object(b.jsxs)("div",{className:"ml-2 mt-2",children:[" ",Object(b.jsx)("span",{children:" Size: "})," ",e.size," cm "]}),Object(b.jsxs)("div",{className:"ml-2 mt-2",children:[" ",Object(b.jsx)("span",{children:" Likes: "})," ",e.location," "]}),Object(b.jsxs)("div",{className:"ml-2 mt-2",children:[" ",Object(b.jsx)("span",{children:" Price: "})," ",e.price," \u20ac "]}),Object(b.jsx)("div",{className:"ml-2 mt-2 col justify-content-center",children:Object(b.jsx)("div",{className:"row-2 justify-content-center",children:Object(b.jsxs)("div",{className:"card-body",children:[a._id===e.creator?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(h.b,{to:"/plant/".concat(e._id,"/edit"),children:[" ",Object(b.jsx)("button",{className:"btn btn-sm ml-2",children:" Edit "})," "]}),Object(b.jsx)("button",{className:"btn btn-sm ml-2",onClick:function(){n(e._id)},children:" Delete "})]}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(h.b,{to:{pathname:"/plant/".concat(e._id,"/checkout"),plant:e},children:Object(b.jsx)("button",{className:"btn btn-sm ml-2 btn-outline-dark",children:" Buy "})}),Object(b.jsx)(h.b,{to:{pathname:"/request-form",plant:e},children:Object(b.jsx)("button",{className:"btn btn-sm ml-2 btn-outline-dark",children:" Swap "})})]}),Object(b.jsx)(h.b,{to:"/",children:Object(b.jsx)("button",{className:"btn btn-sm ml-2 ",children:" Go back "})})]})})})]})})]}):Object(b.jsx)(O.a,{to:"/signup"})}}]),n}(a.Component),D=n(27),U=n.n(D),_=n(36),z=n(24),A=n(22);var M=function(e){var t=Object(a.useState)(!1),n=Object(z.a)(t,2),c=n[0],s=n[1],r=Object(a.useState)(null),i=Object(z.a)(r,2),l=i[0],o=i[1],d=Object(a.useState)(""),j=Object(z.a)(d,2),u=j[0],m=j[1],p=Object(a.useState)(!0),O=Object(z.a)(p,2),x=O[0],g=O[1],v=Object(a.useState)(""),y=Object(z.a)(v,2),N=y[0],S=y[1],w=Object(A.useStripe)(),C=Object(A.useElements)();Object(a.useEffect)((function(){window.fetch("".concat(f,"/api/create-payment-intent"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:[{id:"xl-tshirt"}]})}).then((function(e){return e.json()})).then((function(e){S(e.clientSecret)}))}),[]);var k=function(){var e=Object(_.a)(U.a.mark((function e(t){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g(t.empty),o(t.error?t.error.message:"");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(_.a)(U.a.mark((function e(t){var n;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),m(!0),e.next=4,w.confirmCardPayment(N,{payment_method:{card:C.getElement(A.CardElement)}});case 4:(n=e.sent).error?(o("Payment failed ".concat(n.error.message)),m(!1)):(o(null),m(!1),s(!0));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=e.plant;return Object(b.jsxs)("div",{className:"container col-9",children:[Object(b.jsxs)("form",{className:"checkoutForm pt-5 mt-5",id:"payment-form",onSubmit:I,children:[Object(b.jsxs)("h2",{className:"text-center mb-2 p-2",children:["  ",q.name," "]}),Object(b.jsxs)("h3",{className:"text-center mb-4 p-2",children:[" ",q.price," \u20ac "]}),Object(b.jsx)(A.CardElement,{className:"p-2",id:"card-element",options:{style:{base:{color:"#32325d",fontFamily:"Arial, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#32325d"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}}},onChange:k}),Object(b.jsx)("div",{className:"row justify-content-center",children:Object(b.jsx)("button",{onClick:e.onCheckout,className:"btn btn-sm mt-5 mb-4",disabled:u||x||c,id:"submit",children:Object(b.jsx)("span",{id:"button-text",children:u?Object(b.jsx)("div",{className:"spinner",id:"spinner"}):"Pay now"})})}),l&&Object(b.jsx)("div",{className:"card-error",role:"alert",children:l}),Object(b.jsxs)("p",{className:c?"result-message text-center":"result-message hidden text-center",children:["Payment succeeded, see the result in your",Object(b.jsxs)("a",{href:"https://dashboard.stripe.com/test/payments",children:[" "," "," Stripe dashboard. "]}),"Refresh the page to pay again."]})]}),Object(b.jsx)("div",{className:"row justify-content-center mt-4",children:Object(b.jsx)(h.b,{to:"/",children:Object(b.jsx)("button",{className:"btn btn-sm",children:" Go back "})})})]})},F=n(50),L=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=Object(F.a)("pk_test_51IQBseEqJqsi8ZD5sJWeLyoMPSxJBKvGcgO3Srmc5UOSqAT6Zp44JmszMSiJGqO9R3eleWrCNyv9TOv9IWmoSLyQ00XHsxNLVR"),t=this.props.location.plant;return Object(b.jsx)("div",{className:"container row mt-5",children:Object(b.jsx)("div",{className:"mt-5 col-11 col-md-6 offset-1 offset-md-5",children:Object(b.jsx)(A.Elements,{stripe:e,children:Object(b.jsx)(M,{onCheckout:this.props.onCheckout,plant:t})})})})}}]),n}(a.Component);var R=function(e){return e.onLogOut(),Object(b.jsx)(b.Fragment,{})},W=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t=this.props.location.plant;return Object(b.jsx)("div",{className:"container row mt-5",children:Object(b.jsxs)("div",{className:"mt-5 col-11 col-md-5 offset-1 offset-md-5",children:[Object(b.jsx)("h4",{className:"mt-5 mb-5",children:" Your mesage "}),Object(b.jsxs)("form",{onSubmit:function(n){return e.props.onRequest(n,t)},children:[Object(b.jsx)("div",{children:Object(b.jsx)("textarea",{className:"mb-4",name:"message",cols:"35",rows:"4"})}),Object(b.jsx)("button",{className:"btn btn-sm",type:"submit",children:" Send "})]})]})})}}]),n}(a.Component),G=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).componentDidMount=function(){e.props.onMyRequests()},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.requests;return t?Object(b.jsx)("div",{className:"container row mt-5",children:Object(b.jsxs)("div",{className:"mt-5 col-11 col-md-5 offset-1 offset-md-5",children:[Object(b.jsx)("h2",{className:"mt-5 mb-5",children:" Your messages "}),n.map((function(e){return e.seller==t._id?Object(b.jsxs)("div",{className:"card p-3 mt-4 ",children:[Object(b.jsxs)("h4",{children:[" Request for ",e.plant.name," "]}),Object(b.jsxs)("p",{children:[" ",e.message," "]})]},e._id):null})),Object(b.jsx)(h.b,{to:"/",children:Object(b.jsx)("button",{className:"btn btn-sm mt-4",children:" Go back "})})]})}):Object(b.jsx)(O.a,{to:"/signup"})}}]),n}(a.Component),T=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).state={loggedInUser:null,error:null,plants:[],query:"",requests:[],fetchingUser:!0},e.fetchAllPlants=function(){g.a.get("".concat(f,"/api/plants")).then((function(t){e.setState({plants:t.data})})).catch((function(e){console.log("Fetching plants failed",e)}))},e.fetchQueryPlants=function(){g.a.get("".concat(f,"/api/plants/search?q=").concat(e.state.query)).then((function(t){e.setState({plants:t.data,ready:!0})})).catch((function(e){console.log("Query fetching failed",e)}))},e.handleChange=function(t){var n=t.target.value;e.setState({query:n},(function(){n?e.fetchQueryPlants():e.fetchAllPlants()}))},e.handleSubmit=function(t){t.preventDefault();var n=t.target.name.value,a=t.target.description.value,c=t.target.size.value,s=t.target.price.value,r=t.target.plantImage.files[0],i=t.target.location.value,o=new FormData;o.append("imageUrl",r),g.a.post("".concat(f,"/api/upload"),o).then((function(t){var r={name:n,description:a,size:c,price:s,image:t.data.image,location:i};g.a.post("".concat(f,"/api/plants/create"),r,{withCredentials:!0}).then((function(t){e.setState({plants:[t.data].concat(Object(l.a)(e.state.plants))},(function(){e.props.history.push("/")}))})).catch((function(e){console.log("Create plant failed",e)}))})).catch((function(e){console.log("Image upload failed",e)}))},e.handleEditPlant=function(t){var n={name:t.name,description:t.description,size:t.size,price:t.price,image:t.image,location:t.location};g.a.patch("".concat(f,"/api/plants/").concat(t._id),n).then((function(){var n=e.state.plants.map((function(e){return t._id===e._id&&(e.name=t.name,e.description=t.description,e.size=t.size,e.price=t.price,e.image=t.image,e.location=t.location),e}));e.setState({plants:n},(function(){e.props.history.push("/")}))})).catch((function(e){console.log("Edit plant failed",e)}))},e.handleDelete=function(t){g.a.delete("".concat(f,"/api/plants/").concat(t)).then((function(){var n=e.state.plants.filter((function(e){return e._id!==t}));e.setState({plants:n},(function(){e.props.history.push("/")}))})).catch((function(e){console.log("Delete plant failed",e)}))},e.handleSignUp=function(t){t.preventDefault();var n={username:t.target.username.value,email:t.target.email.value,password:t.target.password.value};g.a.post("".concat(f,"/api/signup"),n).then((function(t){e.setState({loggedInUser:t.data},(function(){e.props.history.push("/")}))})).catch((function(t){e.setState({error:t.data})}))},e.handleSignIn=function(t){t.preventDefault();var n={email:t.target.email.value,password:t.target.password.value};g.a.post("".concat(f,"/api/signin"),n,{withCredentials:!0}).then((function(t){e.setState({loggedInUser:t.data},(function(){e.props.history.push("/")}))})).catch((function(e){console.log("Sihn in failed",e)}))},e.handleLogOut=function(){g.a.post("".concat(f,"/api/logout"),{},{withCredentials:!0}).then((function(){e.setState({loggedInUser:null},(function(){e.props.history.push("/")}))})).catch((function(e){console.log("Logout failed",e)}))},e.handleCheckout=function(){g.a.post("".concat(f,"/api/create-payment-intent"),{},{withCredentials:!0}).then((function(){e.setState((function(){e.props.history.push("/")}))})).catch((function(e){console.log("Checkout failed",e)}))},e.handleRequestSubmit=function(t,n){t.preventDefault();var a=t.target.message.value,c={buyer:e.state.loggedInUser._id,seller:n.creator,plant:n,message:a};g.a.post("".concat(f,"/api/plants/request"),c,{withCredentials:!0}).then((function(t){e.setState({requests:[t.data].concat(Object(l.a)(e.state.requests))},(function(){e.props.history.push("/")}))})).catch((function(e){console.log("Create request failed",e)}))},e.handleMyRequests=function(){g.a.get("".concat(f,"/api/myrequests")).then((function(t){console.log("Response -- handleMyRequests():",t.data),e.setState({requests:t.data})})).catch((function(e){console.log("Fetching requests failed",e)}))},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.fetchAllPlants(),this.state.loggedInUser||g.a.get("".concat(f,"/api/user"),{withCredentials:!0}).then((function(t){e.setState({loggedInUser:t.data,fetchingUser:!1})})).catch((function(t){e.setState({fetchingUser:!1}),console.log("Initializing fetching failed",t)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.plants,a=t.loggedInUser,c=t.error,s=t.query,r=t.requests;return this.state.fetchingUser,Object(b.jsxs)("div",{class:"main",children:[Object(b.jsx)(I,{onLogOut:this.handleLogOut,user:a}),Object(b.jsxs)(O.d,{children:[Object(b.jsx)(O.b,{exact:!0,path:"/",render:function(){return Object(b.jsx)(w,{onSearch:e.handleChange,plants:n,query:s})}}),Object(b.jsx)(O.b,{path:"/plants/:plantId",render:function(t){return Object(b.jsx)(J,Object(i.a)({onDelete:e.handleDelete,user:a},t))}}),Object(b.jsx)(O.b,{path:"/signin",render:function(t){return Object(b.jsx)(m,Object(i.a)({onSignIn:e.handleSignIn},t))}}),Object(b.jsx)(O.b,{path:"/signup",render:function(t){return Object(b.jsx)(p,Object(i.a)({onSignUp:e.handleSignUp,error:c},t))}}),Object(b.jsx)(O.b,{path:"/logout",render:function(t){return Object(b.jsx)(R,Object(i.a)({onLogOut:e.handleLogOut},t))}}),Object(b.jsx)(O.b,{path:"/add-form",render:function(){return Object(b.jsx)(P,{onAdd:e.handleSubmit,user:a})}}),Object(b.jsx)(O.b,{path:"/plant/:plantId/edit",render:function(t){return Object(b.jsx)(E,Object(i.a)({onEdit:e.handleEditPlant},t))}}),Object(b.jsx)(O.b,{path:"/plant/:plantId/checkout",render:function(t){return Object(b.jsx)(L,Object(i.a)({onCheckout:e.handleCheckout},t))}}),Object(b.jsx)(O.b,{path:"/request-form",render:function(t){return Object(b.jsx)(W,Object(i.a)({onRequest:e.handleRequestSubmit,user:a},t))}}),Object(b.jsx)(O.b,{path:"/myrequests",render:function(t){return Object(b.jsx)(G,Object(i.a)({onMyRequests:e.handleMyRequests,user:a,requests:r},t))}})]}),Object(b.jsx)(q,{})]})}}]),n}(a.Component),B=Object(O.g)(T);r.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(h.a,{children:Object(b.jsx)(B,{})})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.99b2b967.chunk.js.map